
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum UserRole {
  customer
  tech
  admin
}

enum Category {
  hardware
  data
  software
  web
  network
  virus
  peripherals
  systems
}

model User { 
  id String @id @default(uuid())
  email String @unique
  name String
  password String
  avatar String
  role UserRole @default(customer)

  requests Requests[] @relation("CustomerRequests")
  assignedRequests Requests[] @relation("TechRequests")

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime? @updatedAt @map("updated_at")

  @@map("users")
}
model Requests {
  id String @id @default(uuid())
  name String
  description String
  estimate Float
  category Category
  filename String

  userId String @map("user_id")
  user User @relation("CustomerRequests", fields: [userId], references: [id])
  techId String? @map("tech_id")
  tech User? @relation("TechRequests", fields: [techId], references: [id])

  parts Parts[] @relation("RequestParts")

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime? @updatedAt @map("updated_at")

  @@map("requests")
}

model Parts {
  id String @id @default(uuid())
  name String
  amount Float

  requestId String? @map("request_id")
  request Requests? @relation("RequestParts", fields: [requestId], references: [id])

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime? @updatedAt @map("updated_at")

  @@map("parts")
}