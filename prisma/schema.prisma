
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum UserRole {
  customer
  tech
  admin
}

enum Category {
  hardware
  data
  software
  web
  network
  virus
  peripherals
  systems
}

enum TicketsStatus {
  open
  in_progress
  closed
}

model User { 
  id String @id @default(uuid())
  email String @unique
  name String
  password String
  avatarImg String
  role UserRole @default(customer)

  tickets Tickets[] @relation("CustomerTickets")
  assignedTickets Tickets[] @relation("TechTickets")

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime? @updatedAt @map("updated_at")

  @@map("users")
}
model Tickets {
  id String @id @default(uuid())
  title String @map("title")
  description String
  estimate Float
  category Category
  filename String
  status TicketsStatus @default(open)
  userId String @map("user_id")
  user User @relation("CustomerTickets", fields: [userId], references: [id])
  techId String? @map("tech_id")
  tech User? @relation("TechTickets", fields: [techId], references: [id])

  servicesId Services[] @relation("TicketsServices")

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime? @updatedAt @map("updated_at")

  @@map("tickets")
}

model Services {
  id String @id @default(uuid())
  name String
  amount Float
  isBasic Boolean @default(true) @map("is_basic")
  ticketId String? @map("ticket_id")
  ticket Tickets? @relation("TicketsServices", fields: [ticketId], references: [id])

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime? @updatedAt @map("updated_at")

  @@map("services")
}